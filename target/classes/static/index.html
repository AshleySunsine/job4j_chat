<!doctype html>
<html lang="en">
  <head>
      <script src="https://code.jquery.com/jquery-3.4.1.min.js"
              integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
      <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
              integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
      <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"
              integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
      <script src="https://code.jquery.com/jquery-3.4.1.min.js" ></script>

      <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" integrity="sha384-zCbKRCUGaJDkqS1kPbPd7TveP5iyJE0EjAuZQTgFLD2ylzuqKfdKlfG/eSrtxUkn" crossorigin="anonymous">
    <link rel="stylesheet" href="./css/main.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <title>Профиль учакстника</title>
  </head>
  <body>

  <script>
      function fillRoom() {
          $.ajax({
              type: "GET",
              url: "http://localhost:8082/rooms/5",
              dataType: "json"
          }).done(
              function (data) {
                  $('#nameOfRoom').text(data['themeOfRoom']);
                  var creatorName;
                  data['participants'].forEach(function(o, i, a) {
                      if(o['id'] == data['creatorId']) {
                          creatorName = o['password'];
                      }
                  });
                  $('#creator__name').text(creatorName);




              }
          );
      }

      var messages;
      function fillTable() {
          $.ajax({
              type: "GET",
              url: "http://localhost:8082/messages/5",
              dataType: "json"
          }).done(function(data) {
                alert(JSON.stringify(data));
              data.forEach(function(item, index, array){
                  $('#messagesTable tr:last').after('<tr><th scope="row">' + 'Отправил: ' + 'Логин-> ' + item['senderId']['login']
                      + ' Пароль-> ' + item['senderId']['password'] + '</th><td>'
                      + item['content'] + '</th><td>'
                      + item['timestamp'] + '</th><td>'
                      + '</td></tr>');
              }
              );
          });
      }
  </script>

    <form class="container">
        
            <div class="user__info">
                <img class = "avatar" src="./img/user__photo.png" alt="user" id="user__photo">
                <h3 class="profile__name" name="creatorName" id="creator__name">Имя участника</h3>
            </div>
        
        <hr class="hr__line">

        <div class="header__table">
          <h4 class="title__table" id="nameOfRoom">Таблица диалога</h4>
          <input type="button" value="Обновить таблицу" name="refresh" id="refresh__table" onclick='fillRoom()'></input>
        </div>

        <table class="table table-striped" id="messagesTable" name="messagesTable">
          <thead>
            <tr>
              <th scope="col">Имя участника</th>
              <th scope="col">Сообщение участника</th>
              <th scope="col">Дата сообщения</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <th scope="row" id="message__sender">name</th>
              <td id="message__text">Lorem ipsum dolor sit amet consectetur adipisicing elit. Beatae cumque hic omnis incidunt suscipit voluptatum perferendis nostrum animi deleniti praesentium, explicabo illo quidem pariatur in tenetur debitis ex placeat nisi.</td>
              <td id="message__date">date</td>
            </tr>



          </tbody>
        </table>

        <hr class="hr__line">

        <span class="message__from">Сообщение:</span>
        <div class="message">
          <textarea class="text" name="message-field" id="text__area" placeholder="Написать сообщение..."></textarea>
        </div>
        <input type="submit" name="submit" value="Отправить" id="send__message">

    </form>
  </body>
</html>